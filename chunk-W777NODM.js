import{L as d,a as s,b as u,i as o}from"./chunk-ESOBYACX.js";var m=class n{cartSubject=new o({amount:0,items:0,products:[]});cart$=this.cartSubject.asObservable();recalculate(t){let r=t.reduce((c,e)=>c+e.quantity,0),i=t.reduce((c,e)=>c+e.quantity*e.product.price,0);return{items:r,amount:i,products:t}}get(){return this.cartSubject.getValue()}set(t){this.cartSubject.next(this.recalculate(t.products))}add(t,r=1){let i=this.get(),c=i.products.find(a=>a.id===t.id),e;c?e=i.products.map(a=>a.id===t.id?u(s({},a),{quantity:a.quantity+r}):a):e=[...i.products,{id:t.id,quantity:r,product:t}],this.cartSubject.next(this.recalculate(e))}decrement(t){let r=this.get(),i=r.products.find(e=>e.id===t);if(!i)return;let c;i.quantity>1?c=r.products.map(e=>e.id===t?u(s({},e),{quantity:e.quantity-1}):e):c=r.products.filter(e=>e.id!==t),this.cartSubject.next(this.recalculate(c))}updateQuantity(t,r){let i=this.get();if(r<=0){let e=i.products.filter(a=>a.id!==t);this.cartSubject.next(this.recalculate(e));return}if(i.products.find(e=>e.id===t)){let e=i.products.map(a=>a.id===t?u(s({},a),{quantity:r}):a);this.cartSubject.next(this.recalculate(e))}}remove(t){let i=this.get().products.filter(c=>c.id!==t);this.cartSubject.next(this.recalculate(i))}clear(){this.cartSubject.next({amount:0,items:0,products:[]})}contains(t){return this.get().products.some(r=>r.id===t)}getQuantity(t){return this.get().products.find(r=>r.id===t)?.quantity??0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=d({token:n,factory:n.\u0275fac,providedIn:"root"})};export{m as a};
